<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Numo::GSL::Fit
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Numo::GSL::Fit";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../x_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Numo.html" title="Numo (module)">Numo</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../GSL.html" title="Numo::GSL (module)">GSL</a></span></span>
     &raquo; 
    <span class="title">Fit</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Numo::GSL::Fit
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>ext/numo/gsl/fit/gsl_fit.c</dd>
  </dl>
  
</div>








  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#linear-class_method" title="linear (class method)">.<strong>linear</strong>(x, y)  &#x21d2; GSL::Fit::LinearResult </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This function computes the best-fit linear regression coefficients (c0,c1) of the model Y = c_0 + c_1 X for the dataset (x, y), two vectors of length n with strides xstride and ystride.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#linear_est-class_method" title="linear_est (class method)">.<strong>linear_est</strong>(x, linear_result)  &#x21d2; [DFloat,DFloat] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This function uses the best-fit linear regression coefficients c0, c1 and their covariance cov00, cov01, cov11 to compute the fitted function y and its standard deviation y_err for the model Y = c_0 + c_1 X at the point x.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mul-class_method" title="mul (class method)">.<strong>mul</strong>(x, y)  &#x21d2; GSL::Fit::MulResult </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This function computes the best-fit linear regression coefficient c1 of the model Y = c_1 X for the datasets (x, y), two vectors of length n with strides xstride and ystride.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mul_est-class_method" title="mul_est (class method)">.<strong>mul_est</strong>(x, mul_result)  &#x21d2; [DFloat,DFloat] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This function uses the best-fit linear regression coefficient c1 and its covariance cov11 to compute the fitted function y and its standard deviation y_err for the model Y = c_1 X at the point x.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#wlinear-class_method" title="wlinear (class method)">.<strong>wlinear</strong>(x, w, y)  &#x21d2; GSL::Fit::WlinearResult </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This function computes the best-fit linear regression coefficients (c0,c1) of the model Y = c_0 + c_1 X for the weighted dataset (x, y), two vectors of length n with strides xstride and ystride.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#wmul-class_method" title="wmul (class method)">.<strong>wmul</strong>(x, w, y)  &#x21d2; GSL::Fit::WmulResult </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This function computes the best-fit linear regression coefficient c1 of the model Y = c_1 X for the weighted datasets (x, y), two vectors of length n with strides xstride and ystride.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="linear-class_method">
  
    .<strong>linear</strong>(x, y)  &#x21d2; <tt>GSL::Fit::LinearResult</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This function computes the best-fit linear regression coefficients
(c0,c1) of the model Y = c_0 + c_1 X for the dataset
(x, y), two vectors of length n with strides
xstride and ystride.  The errors on y are assumed unknown so
the variance-covariance matrix for the
parameters (c0, c1) is estimated from the scatter of the
points around the best-fit line and returned via the parameters
(cov00, cov01, cov11).
The sum of squares of the residuals from the best-fit line is returned
in sumsq.  Note: the correlation coefficient of the data can be computed using gsl_stats_correlation (Correlation), it does not depend on the fit.</p>


  </div>
</div>
<div class="tags">
  
  
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>x</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>y</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>GSL::Fit::LinearResult</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>result Struct with members: c0, c1, cov00, cov01, cov11, sumsq.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/numo/gsl/fit/gsl_fit.c', line 73</span>

static VALUE
fit_s_linear(VALUE mod, VALUE v1, VALUE v2)
{
    VALUE r, result;
    ndfunc_arg_in_t ain[2] = {{cDF,1},{cDF,1}};
    ndfunc_arg_out_t aout[6] = {{cDF,0},{cDF,0},{cDF,0},{cDF,0},{cDF,0},{cDF,0}};
    ndfunc_t ndf = { iter_fit_s_linear, NO_LOOP|NDF_EXTRACT,
                     2, 6, ain, aout };
    narray_t *x, *y;

    GetNArray(v1,x);
    GetNArray(v2,y);
    CHECK_GE_1D(x);
    CHECK_GE_1D(y);
    CHECK_SIZE_EQ(VEC_SIZE(x),VEC_SIZE(y),&quot;x size does not match y size&quot;);

    r = na_ndloop(&amp;ndf, 2, v1, v2);
    result = rb_class_new_instance(6, RARRAY_PTR(r), cLinearResult);
    RB_GC_GUARD(r);
    return result;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="linear_est-class_method">
  
    .<strong>linear_est</strong>(x, linear_result)  &#x21d2; <tt>[DFloat,DFloat]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This function uses the best-fit linear regression coefficients
c0, c1 and their covariance
cov00, cov01, cov11 to compute the fitted function
y and its standard deviation y_err for the model Y =
c_0 + c_1 X at the point x.</p>


  </div>
</div>
<div class="tags">
  
  
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>x</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>linear_result</span>
      
      
        <span class='type'>(<tt>(L|Wl)inearResult</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><table>
  <tbody>
    <tr>
      <td>Result of GSL::Fit.linear</td>
      <td>wlinear</td>
    </tr>
  </tbody>
</table>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[DFloat,DFloat]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>array of (y, y_err).</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/numo/gsl/fit/gsl_fit.c', line 215</span>

static VALUE
fit_s_linear_est(VALUE mod, VALUE v1, VALUE v2)
{
    ndfunc_arg_in_t ain[6] = {{cDF,0},{cDF,0},{cDF,0},{cDF,0},{cDF,0},{cDF,0}};
    ndfunc_arg_out_t aout[2] = {{cDF,0},{cDF,0}};
    ndfunc_t ndf = { iter_fit_s_linear_est, STRIDE_LOOP_NIP|NDF_EXTRACT,
                     6, 2, ain, aout };
    VALUE c0, c1, cov00, cov01, cov11;

    c0 = RSTRUCT_GET(v2,0);
    c1 = RSTRUCT_GET(v2,1);
    cov00 = RSTRUCT_GET(v2,2);
    cov01 = RSTRUCT_GET(v2,3);
    cov11 = RSTRUCT_GET(v2,4);
    return na_ndloop(&amp;ndf, 6, v1, c0, c1, cov00, cov01, cov11);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="mul-class_method">
  
    .<strong>mul</strong>(x, y)  &#x21d2; <tt>GSL::Fit::MulResult</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This function computes the best-fit linear regression coefficient
c1 of the model Y = c_1 X for the datasets (x,
y), two vectors of length n with strides xstride and
ystride.  The errors on y are assumed unknown so the
variance of the parameter c1 is estimated from
the scatter of the points around the best-fit line and returned via the
parameter cov11.  The sum of squares of the residuals from the
best-fit line is returned in sumsq.</p>


  </div>
</div>
<div class="tags">
  
  
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>x</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>y</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>GSL::Fit::MulResult</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>result Struct with members: c1, cov11, sumsq.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/numo/gsl/fit/gsl_fit.c', line 271</span>

static VALUE
fit_s_mul(VALUE mod, VALUE v1, VALUE v2)
{
    VALUE r, result;
    ndfunc_arg_in_t ain[2] = {{cDF,1},{cDF,1}};
    ndfunc_arg_out_t aout[3] = {{cDF,0},{cDF,0},{cDF,0}};
    ndfunc_t ndf = { iter_fit_s_mul, STRIDE_LOOP_NIP|NDF_EXTRACT,
                     2, 3, ain, aout };
    narray_t *x,*y;

    GetNArray(v1,x);
    GetNArray(v2,y);
    CHECK_GE_1D(x);
    CHECK_GE_1D(y);
    CHECK_SIZE_EQ(VEC_SIZE(x),VEC_SIZE(y),&quot;x size does not match y size&quot;);

    r = na_ndloop(&amp;ndf, 2, v1, v2);
    result = rb_class_new_instance(3, RARRAY_PTR(r), cMulResult);
    RB_GC_GUARD(r);
    return result;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="mul_est-class_method">
  
    .<strong>mul_est</strong>(x, mul_result)  &#x21d2; <tt>[DFloat,DFloat]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This function uses the best-fit linear regression coefficient c1
and its covariance cov11 to compute the fitted function
y and its standard deviation y_err for the model Y =
c_1 X at the point x.</p>


  </div>
</div>
<div class="tags">
  
  
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>x</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>mul_result</span>
      
      
        <span class='type'>(<tt>(M|Wm)ulResult</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><table>
  <tbody>
    <tr>
      <td>Result of GSL::Fit.mul</td>
      <td>wmul</td>
    </tr>
  </tbody>
</table>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[DFloat,DFloat]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>array of [y,y_err]</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


402
403
404
405
406
407
408
409
410
411
412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/numo/gsl/fit/gsl_fit.c', line 402</span>

static VALUE
fit_s_mul_est(VALUE mod, VALUE v1, VALUE v2)
{
    ndfunc_arg_in_t ain[3] = {{cDF,0},{cDF,0},{cDF,0}};
    ndfunc_arg_out_t aout[2] = {{cDF,0},{cDF,0}};
    ndfunc_t ndf = { iter_fit_s_mul_est, STRIDE_LOOP_NIP|NDF_EXTRACT,
                     3, 2, ain, aout };
    VALUE c1, cov11;

    c1 = RSTRUCT_GET(v2,0);
    cov11 = RSTRUCT_GET(v2,1);
    return na_ndloop(&amp;ndf, 3, v1, c1, cov11);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="wlinear-class_method">
  
    .<strong>wlinear</strong>(x, w, y)  &#x21d2; <tt>GSL::Fit::WlinearResult</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This function computes the best-fit linear regression coefficients
(c0,c1) of the model Y = c_0 + c_1 X for the weighted
dataset (x, y), two vectors of length n with strides
xstride and ystride.  The vector w, of length n
and stride wstride, specifies the weight of each datapoint. The
weight is the reciprocal of the variance for each datapoint in y.</p>

<p>The covariance matrix for the parameters (c0, c1) is
computed using the weights and returned via the parameters
(cov00, cov01, cov11).  The weighted sum of squares
of the residuals from the best-fit line, \chi^2, is returned in
chisq.</p>


  </div>
</div>
<div class="tags">
  
  
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>x</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>w</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>y</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>GSL::Fit::WlinearResult</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>result Struct with members: c0, c1, cov00, cov01, cov11, chisq.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/numo/gsl/fit/gsl_fit.c', line 144</span>

static VALUE
fit_s_wlinear(VALUE mod, VALUE v1, VALUE v2, VALUE v3)
{
    ndfunc_arg_in_t ain[3] = {{cDF,1},{cDF,1},{cDF,1}};
    ndfunc_arg_out_t aout[6] = {{cDF,0},{cDF,0},{cDF,0},{cDF,0},{cDF,0},{cDF,0}};
    ndfunc_t ndf = { iter_fit_s_wlinear, STRIDE_LOOP_NIP|NDF_EXTRACT,
                     3, 6, ain, aout };
    narray_t *x, *y, *w;
    VALUE r, result;

    GetNArray(v1,x);
    GetNArray(v2,y);
    GetNArray(v3,w);
    CHECK_GE_1D(x);
    CHECK_GE_1D(y);
    CHECK_GE_1D(w);
    CHECK_SIZE_EQ(VEC_SIZE(x),VEC_SIZE(y),&quot;y size does not match x size&quot;);
    CHECK_SIZE_EQ(VEC_SIZE(x),VEC_SIZE(w),&quot;w size does not match x size&quot;);

    r = na_ndloop(&amp;ndf, 3, v1, v2, v3);
    result = rb_class_new_instance(6, RARRAY_PTR(r), cWlinearResult);
    RB_GC_GUARD(r);
    return result;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="wmul-class_method">
  
    .<strong>wmul</strong>(x, w, y)  &#x21d2; <tt>GSL::Fit::WmulResult</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This function computes the best-fit linear regression coefficient
c1 of the model Y = c_1 X for the weighted datasets
(x, y), two vectors of length n with strides
xstride and ystride.  The vector w, of length n
and stride wstride, specifies the weight of each datapoint. The
weight is the reciprocal of the variance for each datapoint in y.</p>

<p>The variance of the parameter c1 is computed using the weights
and returned via the parameter cov11.  The weighted sum of
squares of the residuals from the best-fit line, \chi^2, is
returned in chisq.</p>


  </div>
</div>
<div class="tags">
  
  
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>x</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>w</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>y</span>
      
      
        <span class='type'>(<tt>DFloat</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(input array)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>GSL::Fit::WmulResult</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>result Struct with members: c1, cov11, sumsq.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/numo/gsl/fit/gsl_fit.c', line 338</span>

static VALUE
fit_s_wmul(VALUE mod, VALUE v1, VALUE v2, VALUE v3)
{
    VALUE r, result;
    ndfunc_arg_in_t ain[3] = {{cDF,1},{cDF,1},{cDF,1}};
    ndfunc_arg_out_t aout[3] = {{cDF,0},{cDF,0},{cDF,0}};
    ndfunc_t ndf = { iter_fit_s_wmul, STRIDE_LOOP_NIP|NDF_EXTRACT,
                     3, 3, ain, aout };
    narray_t *x,*y,*w;

    GetNArray(v1,x);
    GetNArray(v2,y);
    GetNArray(v3,w);
    CHECK_GE_1D(x);
    CHECK_GE_1D(y);
    CHECK_GE_1D(w);
    CHECK_SIZE_EQ(VEC_SIZE(x),VEC_SIZE(y),&quot;y size does not match x size&quot;);
    CHECK_SIZE_EQ(VEC_SIZE(x),VEC_SIZE(w),&quot;w size does not match x size&quot;);

    r = na_ndloop(&amp;ndf, 3, v1, v2, v3);
    result = rb_class_new_instance(3, RARRAY_PTR(r), cWmulResult);
    RB_GC_GUARD(r);
    return result;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jan 18 17:28:55 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.5.0).
</div>

    </div>
  </body>
</html>